# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–ö–ò CORS

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞:
```
Access to fetch at 'https://cold-rice-yawn.loca.lt/' from origin 'http://localhost:3000' 
has been blocked by CORS policy: Response to preflight request doesn't pass access 
control check: No 'Access-Control-Allow-Origin' header is present on the requested resource.
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ:

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS –≤ `backend/app/main.py`:
- –û—Ç–∫–ª—é—á–µ–Ω `allow_credentials` (–Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º —Å `allow_origins=["*"]`)
- –Ø–≤–Ω–æ —É–∫–∞–∑–∞–Ω—ã –º–µ—Ç–æ–¥—ã HTTP
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ OPTIONS –∑–∞–ø—Ä–æ—Å–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω `expose_headers` –∏ `max_age`

## üöÄ –ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨:

### 1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend

**–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π backend** (Ctrl+C –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≥–¥–µ –∑–∞–ø—É—â–µ–Ω `python run.py`)

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:**
```bash
cd backend
python run.py
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
Uvicorn running on http://0.0.0.0:8000
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ localtunnel –∞–∫—Ç–∏–≤–µ–Ω

–í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```bash
lt --port 8000
```

–ò –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å URL (–º–æ–∂–µ—Ç –±—ã—Ç—å –¥—Ä—É–≥–æ–π, –Ω–µ `cold-rice-yawn.loca.lt`)

### 4. –û–±–Ω–æ–≤–∏—Ç–µ .env –µ—Å–ª–∏ URL –∏–∑–º–µ–Ω–∏–ª—Å—è

–ï—Å–ª–∏ localtunnel –ø–æ–∫–∞–∑–∞–ª –Ω–æ–≤—ã–π URL, –æ–±–Ω–æ–≤–∏—Ç–µ `miniapp/react-app/.env`:
```
REACT_APP_API_URL=https://–Ω–æ–≤—ã–π-url.loca.lt
```

### 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ React

```bash
cd miniapp/react-app
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ (Ctrl+C)
npm start
```

### 6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) - –æ—à–∏–±–∫–∏ CORS –¥–æ–ª–∂–Ω—ã –∏—Å—á–µ–∑–Ω—É—Ç—å.

## üîç –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ):

### –ü—Ä–æ–±–ª–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ localtunnel

Localtunnel –∏–Ω–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:

**–í–∞—Ä–∏–∞–Ω—Ç 1: ngrok**
```bash
ngrok http 8000
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: Cloudflare Tunnel**
```bash
cloudflared tunnel --url http://localhost:8000
```

**–í–∞—Ä–∏–∞–Ω—Ç 3: –Ø–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å origin –≤ CORS**

–ï—Å–ª–∏ –∑–Ω–∞–µ—Ç–µ —Ç–æ—á–Ω—ã–π origin (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è Telegram WebApp), –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –µ–≥–æ —è–≤–Ω–æ:

–í `backend/app/main.py` –∑–∞–º–µ–Ω–∏—Ç–µ:
```python
allow_origins=["*"],
```

–ù–∞:
```python
allow_origins=[
    "http://localhost:3000",
    "https://web.telegram.org",
    "https://*.telegram.org",
],
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç:

- [ ] Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] Backend –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8000
- [ ] localtunnel (–∏–ª–∏ –¥—Ä—É–≥–æ–π —Ç—É–Ω–Ω–µ–ª—å) –∑–∞–ø—É—â–µ–Ω
- [ ] .env —Ñ–∞–π–ª –æ–±–Ω–æ–≤–ª–µ–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º URL
- [ ] React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–æ
- [ ] –û—à–∏–±–∫–∏ CORS –∏—Å—á–µ–∑–ª–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

## ‚ö†Ô∏è –í–∞–∂–Ω–æ:

- **–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è backend –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä**
- **–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è .env –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ React**
- **URL localtunnel –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ**

