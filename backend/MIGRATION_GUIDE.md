# Руководство по миграции базы данных

## Проблема
После обновления модели `Booking` нужно добавить новые колонки в таблицу `bookings`:
- `admin_response` (TEXT) - ответ администратора на консультацию
- `admin_id` (INTEGER) - ID администратора, который ответил

## Решение

### Вариант 1: Автоматическая миграция (рекомендуется)

1. **Убедитесь, что база данных существует:**
   - Запустите backend приложение один раз: `python -m uvicorn app.main:app --reload`
   - Это создаст базу данных и все таблицы

2. **Выполните миграцию:**
   ```bash
   cd backend
   python migrate_bookings_table.py
   ```

3. **Теперь можно удалить тестовые данные:**
   ```bash
   python remove_test_data.py
   ```

### Вариант 2: Ручная миграция через SQL

Если автоматическая миграция не работает, выполните SQL команды напрямую:

```sql
ALTER TABLE bookings ADD COLUMN admin_response TEXT;
ALTER TABLE bookings ADD COLUMN admin_id INTEGER;
```

### Вариант 3: Пересоздание базы данных

Если у вас нет важных данных, можно просто удалить базу данных и пересоздать:

1. Удалите файл `db.sqlite3` в корне проекта
2. Запустите приложение - база создастся автоматически с правильной структурой

## Проверка миграции

После миграции проверьте структуру таблицы:

```sql
PRAGMA table_info(bookings);
```

Должны быть колонки:
- id
- user_id
- webinar_id
- type
- date
- time
- status
- topic
- message
- **admin_response** (новая)
- **admin_id** (новая)

